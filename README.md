# anonymousBOT

これは高度な機能を備えた、匿名メッセージ投稿のためのDiscordボットです。

## 🌟 主な機能

### ユーザー向け機能
- **匿名投稿**: `/post` コマンドで、誰にも正体を知られることなくメッセージを投稿できます。画像などのファイル添付も可能です。
- **匿名返信**: `/reply` コマンドで、特定のメッセージに対して匿名で返信できます。
- **匿名スレッド作成**: `/th` コマンドで、匿名で新しいスレッドを開始できます。
- **投稿の自己削除**: `/delete` コマンドで、自分が投稿した匿名メッセージを削除できます。
- **誤投稿の自動変換**: 通常のメッセージを誤って投稿してしまっても、設定されたチャンネルであれば自動で匿名投稿に変換するかどうかを尋ねるメッセージが表示されます。

### 管理者向け機能
- **投稿者の特定**: `/trace` コマンドで、メッセージIDから匿名投稿の投稿者を特定できます。
- **ユーザー投稿の検索**: `/user_posts` コマンドで、特定のユーザーの匿名投稿を期間を指定して一覧表示できます。
- **ユーザーBAN**: `/ban` コマンドで、特定のユーザーをサーバー内、またはBOT全体での匿名投稿から禁止できます。
- **BAN解除**: `/unban` コマンドで、ユーザーのBANを解除できます。
- **投稿の一括削除**: `/bulk_delete` コマンドで、ユーザー指定、期間指定、キーワード指定など、様々な条件で匿名投稿を一括で論理削除できます。
- **柔軟な設定変更**: `/config` コマンドで、レート制限、NGワード、匿名IDのフォーマットなど、サーバーごとの細かい設定を管理できます。
- **管理ログの確認**: `/admin_logs` コマンドで、管理者コマンドの実行履歴を確認できます。

### セキュリティとプライバシー
- **ユーザーIDの暗号化**: 投稿者のDiscordユーザーIDは、サーバーごとに異なる鍵で暗号化されてデータベースに保存されるため、プライバシーが保護されます。
- **日替わりID**: 匿名IDは、デフォルトで毎日リセットされるため、長期間にわたる追跡を防ぎます。
- **レート制限**: 短時間に連続して投稿することを防ぐレートリミット機能があります。
- **NGワード**: サーバーごとにNGワードを設定し、不適切な投稿をブロックできます。

## 🚀 セットアップ方法

このボットはDocker Composeを使用して簡単にデプロイできます。

1.  **リポジトリのクローン**:
    ```bash
    git clone https://github.com/your-username/anonymousBOT.git
    cd anonymousBOT
    ```

2.  **環境変数の設定**:
    `.env.example` ファイルをコピーして `.env` ファイルを作成します。
    ```bash
    cp .env.example .env
    ```
    その後、`.env` ファイルを編集し、以下の必須項目を設定してください。
    - `DISCORD_BOT_TOKEN`: あなたのDiscordボットのトークン
    - `POSTGRES_PASSWORD`: データベースのパスワード（任意の安全な文字列）

3.  **ボットの起動**:
    以下のコマンドを実行して、ボットとデータベースを起動します。
    ```bash
    docker-compose up --build -d
    ```
    このコマンドは、初回起動時にDockerイメージをビルドし、データベースのマイグレーションを自動的に実行してからボットを起動します。

4.  **ボットの停止**:
    ```bash
    docker-compose down
    ```

## 使い方

Discordサーバーにボットを招待し、各スラッシュコマンド（`/`から始まるコマンド）を使用してください。管理者向けコマンドは、サーバーの管理権限を持つユーザーのみが実行できます。